#https://stackoverflow.com/questions/63990487/package-conflict-with-anaconda
#IMPORTANT: By telling conda that it can visit multiple channels (conda-forge, bioconda and defaults), it has some extra options to resolve the dependency conflicts.

#-- prokka need to be installed with root-env --> FAILED
#sudo apt install prokka
#--> no databases: https://github.com/tseemann/prokka/issues/540

#-- prokka to be installed under base-env --> FAILED
conda activate base
(base) conda install -c conda-forge -c bioconda -c defaults prokka
#sudo apt-get install libdatetime-perl libxml-simple-perl libdigest-md5-perl git default-jre bioperl
#sudo cpan Bio::Perl
#git clone https://github.com/tseemann/prokka.git $HOME/prokka
#$HOME/prokka/bin/prokka --setupdb
(base) conda install -c conda-forge -c bioconda -c defaults perl-bioperl perl-datetime perl-xml-simple perl-digest-md5
(base) cpanm Bio::Root::Version
conda deactivate


conda create -n bacto2 -c conda-forge -c bioconda -c defaults python=3.7
conda activate bacto2
(bacto2) conda install -c conda-forge -c bioconda -c defaults trimmomatic fastqc shovill 
(bacto2) conda install -c conda-forge -c bioconda -c defaults mlst roary snippy fasttree 
(bacto2) conda install -c conda-forge -c bioconda -c defaults raxml-ng gubbins snp-sites
#conda install -c conda-forge -c bioconda -c defaults biopython

conda create -n prokka -c conda-forge -c bioconda -c defaults python=3.7 prokka
(prokka) conda install -c conda-forge -c bioconda -c defaults shovill mlst trimmomatic 

(prokka) for the steps trimmomatic + shovill + prokka + mlst (f,f,t,t,t,f,f,f,f,f in bacto-0.1.json)
(bacto2) running the remaining steps (f,f,f,f,f,t,t,t,t,t in bacto-0.1.json)




#---------------------------------------- TRASH ---------------------------------------
#----install BioPerl in root-env----
#sudo apt install cpanminus
#cpanm Bio::Root::Version  #--> Successfully installed BioPerl-1.7.8 (upgraded from 1.7.7)


#conda create -n bacto3 python=3.7 libgcc-ng=7.3 libstdcxx-ng=7.3
#conda install -c bioconda prokka perl-bioperl
conda install -c bioconda prokka perl-bioperl perl-datetime perl-xml-simple perl-digest-md5 perl-bio-searchio-hmmer
#-->ERROR: ! Installing the dependencies failed: Module 'XML::Parser::PerlSAX' is not installed, Module 'DB_File' is not installed, Module 'XML::LibXML' is not installed, Module 'Test::Memory::Cycle' is not installed, Module 'XML::DOM' is not installed, Module 'Graph::Directed' is not installed, Module 'XML::Twig' is not installed, Module 'XML::LibXML::Reader' is not installed
! Bailing out the installation for BioPerl-1.7.8.

#conda install -c bioconda trimmomatic fastqc shovill prokka mlst roary snippy fasttree raxml-ng gubbins snp-sites
conda install -c bioconda trimmomatic roary fasttree raxml-ng mlst gubbins
conda install -c conda-forge biopython

#---- brew is not a good idea: DEACTIVATing it in .bashrc ----
#DEBUG prokka error: https://github.com/tseemann/prokka/issues/446
#cpan 
#install Bio::Perl Time::Piece XML::Simple Digest::MD5
#conda install -c bioconda perl-xml-simple perl-bioperl
#Solution: https://github.com/tseemann/prokka/issues/528
#sudo apt install bioperl libdatetime-perl libxml-simple-perl libdigest-md5-perl libbio-searchio-hmmer-perl

#brew install brewsci/bio/prokka
#brew install brewsci/bio/shovill
#brew install brewsci/bio/snippy  #which also installs snp-sites

#conda env create -f=envs/bengal_m.yaml    # python3 is included
#conda env update -f=envs/mykrobe_m.yaml
#conda activate bengal3_ac3
conda install -c bioconda ariba
#conda install snp-sites
conda install seq-seq-pan


#conda remove -n bengal --all
#conda remove -n bengal2 --all

